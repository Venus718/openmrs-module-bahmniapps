<div class="vitals form-horizontal">
    <fieldset ng-if="!node.isGroup()">
        <div class="form-group">
            <label class="control-label">
                <span>{{node.label}}</span>
                <span ng-show="node.units">({{node.units}})</span>
                <span ng-show="node.isRequired" class="asterick">*</span>
            </label>
            <div class="field-value" ng-switch on="node.getControlType()">
                <div ng-switch-when="html5InputDataType">
                    <input ng-class="{'illegalValue': !node.isValid(atLeastOneValueIsSet)}"
                           obs-constraints obs="$parent.node"
                           class="form-control" ng-model="$parent.node.primaryObservation.value"
                           ng-change="$parent.node.onValueChanged()"/>
                           <small class="hint" ng-show="node.lowAbsolute || node.highAbsolute">(Valid Range from {{node.lowAbsolute}} to {{node.hiAbsolute}})</small>
                </div>

                <div ng-switch-when="freeTextAutocomplete">
                    <input class="concept-name" ng-model="node.primaryObservation.value" concept-autocomplete
                       ng-class="{'illegalValue': !node.isValid(atLeastOneValueIsSet)}"
                       coded-concept-uuid="node.getConceptConfig().freeTextAutocomplete.codedConceptUuid"
                       concept-set-uuid="node.getConceptConfig().freeTextAutocomplete.conceptSetUuid"
                       blur-on-select="false"/>
                </div>

                <textarea ng-switch-when="text" class="form-control" ng-model="$parent.node.primaryObservation.value"
                          ng-class="{'illegalValue': !node.isValid(atLeastOneValueIsSet)}"
                          ng-change="$parent.node.onValueChanged()"></textarea>

                <select ng-switch-when="dropdown" foo-bar class="form-control" ng-model="node.primaryObservation.value" ng-change="node.onValueChanged()"
                        ng-class="{'illegalValue': !node.isValid(atLeastOneValueIsSet)}"
                        ng-options="answer as answer.name for answer in getPossibleAnswers() track by answer.uuid"> <option value=""></option>
                </select>

                <div ng-class="{'illegalValue': !node.isValid(atLeastOneValueIsSet)}"
                     ng-switch-when="autocomplete" class="autocomplete">
                    <input ui-select2="selectOptions"
                           class="form-control" ng-model="node.primaryObservation.value"
                           ng-change="node.onValueChanged()">
                    </input>
                </div>

                <p ng-switch-default class="field-value info icon-info-sign"> The concept data type '{{$parent.node.dataTypeName}}' is not supported yet.</p>
            </div>
            <div class="checkbox-inline" ng-if="node.showAbnormalIndicator">
              <input id="isAbnormal" type="checkbox" ng-model="node.abnormalityObservation.value" />
              <span for="isAbnormal">Abnormal</span>
            </div>
        </div>
    </fieldset>

    <fieldset ng-if="node.isGroup()" class="hasLegend">
        <legend class="mylegend"><strong>{{node.label}}</strong></legend>
        <div class="form-group">
            <div class="form-field form-field-group" ng-repeat="member in node.children">
                <concept node="member" at-least-one-value-is-set="atLeastOneValueIsSet"></concept>
            </div>
        </div>
    </fieldset>
</div>
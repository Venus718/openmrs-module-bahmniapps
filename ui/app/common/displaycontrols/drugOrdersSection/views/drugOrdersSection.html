<h2 class="has-toggle section-title" ng-if="config | titleTranslate" ng-click="toggleDisplay()">
    <i class="fa fa-caret-right" ng-hide="toggle"></i>
    <i class="fa fa-caret-down ng-hide" ng-show="toggle"></i>
    <span class="section-label">{{ config | titleTranslate }}</span>
</h2>
<p class="placeholder-text" ng-if="drugOrders && drugOrders.length == 0">{{'NO_DRUG_DETAILS_MESSAGE' | translate}} </p>
<div class="overflowAuto">
    <table ng-if="drugOrders && drugOrders.length > 0" class="drug-order-table treatments-details-table" ng-show="toggle">
        <tr>
            <th ng-repeat="columnName in columns" ng-class="columnName">{{columnHeaders[columnName] | translate}}</th>
            <th class="empty-header" ng-if="config.actions" ng-class="{'custom-empty-header': columns.length > 9}">&nbsp;</th>
        </tr>
        <tbody ng-repeat="drugOrder in drugOrders">
        <tr ng-class="{'highlight' : drugOrder.isBeingEdited, 'edited' : drugOrder.isMarkedForDiscontinue}">
            <td ng-repeat="columnName in columns" class="{{columnName}}" ng-class="{'noActionColumn' :!config.actions}">
                <span ng-if="columnName === 'drugName'">{{::drugOrder.getDrugOrderName(false)}}</span>
                <span ng-if="columnName === 'dosage'">{{::drugOrder.dosage}}</span>
                <span ng-if="columnName === 'route'">{{::drugOrder.route}}</span>
                <span ng-if="columnName === 'duration'">{{::drugOrder.getDurationAndDurationUnits()}}</span>
                <span ng-if="columnName === 'frequency'">{{::drugOrder.getFrequency()}}</span>
                <span ng-if="columnName === 'startDate'">{{::drugOrder.effectiveStartDate | bahmniDate}}</span>
                <span ng-if="columnName === 'stopDate' && drugOrder.isDiscontinuedOrStopped()">{{::drugOrder.effectiveStopDate | bahmniDate}}</span>
                <span ng-if="columnName === 'stopReason' && drugOrder.orderReasonConcept">{{::drugOrder.orderReasonConcept.display || drugOrder.orderReasonConcept.name}}</span>
                <span ng-if="columnName === 'stopReasonNotes' && drugOrder.orderReasonText">{{::drugOrder.orderReasonText}}</span>
                <span ng-if="columnName === 'additionalInstructions'">{{::drugOrder.additionalInstructions}}</span>
                <span ng-if="columnName === 'instructions'">{{::drugOrder.instructions}}</span>
                <span ng-if="columnName === 'quantity'">{{::drugOrder.getQuantityWithUnit()}}</span>
            </td>
            <td ng-if="config.actions">
                <div class="button-group-wrapper">
                    <div class="button-group"  ng-repeat="actionName in config.actions">
                        <button ng-if="actionName=='revise'" ng-disabled="!drugOrder.isActive() || !drugOrder.isEditAllowed" ng-click="revise(drugOrder, drugOrders)">
                            <i class="fa fa-edit"></i>
                        </button>
                        <button class="undo-btn" ng-if=" actionName=='stop' && drugOrder.isMarkedForDiscontinue" ng-disabled="!drugOrder.isActive() || !drugOrder.isDiscontinuedAllowed" ng-click="undoDiscontinue(drugOrder)">
                            <i class="fa fa-undo"></i>
                        </button>
                        <button class="stop-drug-btn" ng-if="actionName=='stop' && !drugOrder.isMarkedForDiscontinue" ng-disabled="!drugOrder.isActive() || !drugOrder.isDiscontinuedAllowed" ng-click="discontinue(drugOrder)">
                            Stop
                        </button>
                        <button class="refill-btn" ng-if="actionName=='refill'" ng-disabled="!drugOrder.effectiveStopDate" ng-click="refill(drugOrder)">
                            Refill
                        </button>
                    </div>
                </div>
            </td>
        </tr>
        <tr ng-if="drugOrder.isMarkedForDiscontinue" ng-class="{'formStopReason' : drugOrder.isMarkedForDiscontinue}">
            <td colspan="48" class="form drug-stop-container">
                <article class="form-field">
                    <div class="field-attribute stop-date-label">
                        <label class="control-label">Stop Date</label>
                    </div>
                    <div class="field-value">
                        <input id="date-stopped" type="date" min="{{::getMinDateForDiscontinue(drugOrder)}}" max="{{::scheduledDate}}" ng-model="drugOrder.dateStopped"
                               required="required">
                    </div>
                    <div class="field-value" ng-if="config.captureStopReason">
                        <select id="stopped-reason" class="form-field instruction" ng-change="updateFormConditions(drugOrder)" ng-model="drugOrder.orderReasonConcept" ng-options="item as item.display for item in stoppedOrderReasons">
                            <option value="">{{ 'MEDICATION_RECENT_TAB_STOP_REASON' | translate }}</option>
                        </select>
                    </div>
                    <div class="field-value" ng-if="config.captureStopReason">
                        <textarea ng-disabled="!drugOrder.orderReasonNotesEnabled" rows="1" id="stopped-reason-non-coded" class="form-field drug-order-notes" placeholder="{{ 'MEDICATION_RECENT_TAB_STOP_NOTES' | translate}}"
                                  ng-model="drugOrder.orderReasonText"></textarea>
                    </div>
                </article>
            </td>
        </tr>

        </tbody>
    </table>
</div>
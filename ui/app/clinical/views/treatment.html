<div class="treatment-page">
    <section class="edit-drug-order section-grid">
        <form name="addForm" ng-submit="add()" ng-class="{ 'show-invalid': formInvalid}" novalidate>
            <fieldset>
                <input class="form-field drug-name" type="text" placeholder="Drug Name" bahmni-autocomplete
                       source="getDrugs" response-map="getDataResults"
                       ng-model="treatment.drugNameDisplay" on-select="populateBackingFields" ng-required="isUniformDosingType()" autofocus/>

                <div class="frequency-widget uniform-frequency" ng-click="treatment.setFrequencyType('uniform')" ng-class="{'disabled': isVariableDosingType()}">
                    <input class="form-field dose" only-number type="number" min="0" placeholder="Dose"
                           ng-model="treatment.uniformDosingType.dose" ng-required="isUniformDosingType()" ng-disabled="isVariableDosingType()"/>
                    <select class="form-field freq-dose-units" ng-model="treatment.uniformDosingType.doseUnits"
                            ng-options="item.name as item.name for item in treatmentConfig.doseUnits" ng-required="isUniformDosingType()"  ng-disabled="isVariableDosingType()">
                        <option value="">&lt;Unit&gt;</option>
                    </select>

                    <div>
                        <select class="form-field frequency" ng-model="treatment.uniformDosingType.frequency"
                                ng-options="item.name as item.name for item in treatmentConfig.frequencies" ng-required="isUniformDosingType()" ng-disabled="isVariableDosingType()">
                            <option value="">&lt;Frequency&gt;</option>
                        </select>
                    </div>
                </div>
                <span class="or-seperator">or</span>

                <div class="frequency-widget variable-frequency" ng-click="treatment.setFrequencyType('variable')" ng-class="{'disabled': isUniformDosingType()}">
                    <div class="form-field dose-cell">
                        <input type="number" min="0" ng-model="treatment.variableDosingType.morningDose" only-number
                               ng-required="isVariableDosingType()" ng-disabled="isUniformDosingType()"/>
                        <input type="number" min="0" ng-model="treatment.variableDosingType.afternoonDose" only-number
                               ng-required="isVariableDosingType()" ng-disabled="isUniformDosingType()"/>
                        <input type="number" min="0" ng-model="treatment.variableDosingType.eveningDose" only-number
                               ng-required="isVariableDosingType()" ng-disabled="isUniformDosingType()"/>
                    </div>
                    <select class="form-field freq-dose-units" ng-model="treatment.variableDosingType.doseUnits"
                            ng-options="item.name as item.name for item in treatmentConfig.doseUnits"
                            ng-change="treatment.setFrequencyType('variable')" ng-required="treatment.frequencyType === 'variable'" ng-disabled="isUniformDosingType()">
                        <option value="">&lt;Unit&gt;</option>
                    </select>
                </div>

                <div class="form-field treatment-prn">
                    <input id="treatmentPrn" type="checkbox" ng-model="treatment.asNeeded"/>
                    <label for="treatmentPrn">SOS</label>
                </div>
            </fieldset>

            <fieldset>
                <select class="form-field instruction" ng-model="treatment.instructions">
                    <option value="">&lt;Instruction&gt;</option>
                    <option value="Before meals">Before meals</option>
                    <option value="Empty stomach">Empty stomach</option>
                    <option value="After meals">After meals</option>
                    <option value="In the morning">In the morning</option>
                    <option value="In the evening">In the evening</option>
                    <option value="At bedtime">At bedtime</option>
                </select>

                <div class="duration-widget">
                    <input class="form-field duration" type="number" min="0" placeholder="Duration"
                           ng-model="treatment.duration" required only-number/>
                    <select class="form-field duration-unit" ng-model="treatment.durationUnit"
                            ng-options="item.name as item.name for item in treatmentConfig.durationUnits" required>
                        <option value="">&lt;Duration&gt;</option>
                    </select>
                    <select class="form-field route" ng-model="treatment.route"
                            ng-options="item.name as item.name for item in treatmentConfig.routes">
                    </select>
                </div>

                <input class="form-field start-date" type="date"
                       ng-model="treatment.scheduledDate" placeholder="dd-mm-yyyy" min="{}">

                <div class="quantity-widget">
                    <input class="form-field quantity" type="number" min="0" ng-model="treatment.quantity" required
                           only-number/>
                    <select class="form-field quantity-unit" ng-model="treatment.quantityUnit"
                            ng-options="item.name as item.name for item in treatmentConfig.dispensingUnits" required>
                        <option value="">&lt;Quantity&gt;</option>
                    </select>
                </div>
            </fieldset>

            <fieldset>
                <textarea class="form-field drug-order-notes" placeholder="Notes" ng-model="treatment.notes"></textarea>
                <input class="form-field add-drug-btn confirm" type="submit" value="Add"/>
            </fieldset>
        </form>
    </section>
    <ng-include src="'views/treatmentSections/newDrugOrders.html'"></ng-include>
    <ng-include src="'views/treatmentSections/drugOrderHistory.html'"></ng-include>
</div>